import{_ as $,u as F}from"./useHelpers.dd5cb996.js";import{_ as j}from"./item.7a02cba8.js";import{p as H,r as x,t as N,q as U,s as A,w as V,u as b,v as q,x as L,y as W,e as C,f as P,i as Z,F as G,j as K,o as g,m as X,c as Y,z as J,A as Q,l as R,k as T}from"./entry.6d944914.js";import{_ as ee}from"./_plugin-vue_export-helper.c27b6911.js";import"./Icon.cdf25d1a.js";import"./config.ef7b244d.js";const te=()=>null;function I(...s){const o=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(o);let[e,i,a={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof i!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??te,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const t=H(),w=()=>t.isHydrating?t.payload.data[e]:t.static.data[e],c=()=>w()!==void 0;t._asyncData[e]||(t._asyncData[e]={data:x(w()??a.default()),pending:x(!c()),error:N(t.payload._errors,e)});const n={...t._asyncData[e]};n.refresh=n.execute=(u={})=>{if(t._asyncDataPromises[e]){if(u.dedupe===!1)return t._asyncDataPromises[e];t._asyncDataPromises[e].cancelled=!0}if((u._initial||t.isHydrating&&u._initial!==!1)&&c())return w();n.pending.value=!0;const h=new Promise((l,f)=>{try{l(i(t))}catch(S){f(S)}}).then(l=>{if(h.cancelled)return t._asyncDataPromises[e];let f=l;a.transform&&(f=a.transform(l)),a.pick&&(f=ae(f,a.pick)),n.data.value=f,n.error.value=null}).catch(l=>{if(h.cancelled)return t._asyncDataPromises[e];n.error.value=l,n.data.value=b(a.default())}).finally(()=>{h.cancelled||(n.pending.value=!1,t.payload.data[e]=n.data.value,n.error.value&&(t.payload._errors[e]=q(n.error.value)),delete t._asyncDataPromises[e])});return t._asyncDataPromises[e]=h,t._asyncDataPromises[e]};const p=()=>n.refresh({_initial:!0}),_=a.server!==!1&&t.payload.serverRendered;{const u=L();if(u&&!u._nuxtOnBeforeMountCbs){u._nuxtOnBeforeMountCbs=[];const l=u._nuxtOnBeforeMountCbs;u&&(U(()=>{l.forEach(f=>{f()}),l.splice(0,l.length)}),A(()=>l.splice(0,l.length)))}_&&t.isHydrating&&c()?n.pending.value=!1:u&&(t.payload.serverRendered&&t.isHydrating||a.lazy)&&a.immediate?u._nuxtOnBeforeMountCbs.push(p):a.immediate&&p(),a.watch&&V(a.watch,()=>n.refresh());const h=t.hook("app:data:refresh",l=>{if(!l||l.includes(e))return n.refresh()});u&&A(h)}const y=Promise.resolve(t._asyncDataPromises[e]).then(()=>n);return Object.assign(y,n),y}function ae(s,o){const e={};for(const i of o)e[i]=s[i];return e}const ne=()=>({fetchShows:async(o=null)=>o!=null&&o.length?await $fetch(`https://api.tvmaze.com/search/shows?q=${o}`,{transform:e=>e.show}):await $fetch("https://api.tvmaze.com/shows")});function M(s){return typeof s=="function"?s():b(s)}const z=()=>{};function se(s,o){function e(...i){return new Promise((a,t)=>{Promise.resolve(s(()=>o.apply(this,i),{fn:o,thisArg:this,args:i})).then(a).catch(t)})}return e}function re(s,o={}){let e,i,a=z;const t=c=>{clearTimeout(c),a(),a=z};return c=>{const n=M(s),p=M(o.maxWait);return e&&t(e),n<=0||p!==void 0&&p<=0?(i&&(t(i),i=null),Promise.resolve(c())):new Promise((_,y)=>{a=o.rejectOnCancel?y:_,p&&!i&&(i=setTimeout(()=>{e&&t(e),i=null,_(c())},p)),e=setTimeout(()=>{i&&t(i),i=null,_(c())},n)})}}function oe(s,o=200,e={}){return se(re(o,e),s)}const ie=s=>(J("data-v-a1a91fee"),s=s(),Q(),s),le={class:"overflow-y-hidden"},ue={key:0,class:"flex items-center snap-x space-x-8 snap-mandatory overflow-scroll px-8 no-scrollbar"},ce={key:1,class:"mt-40"},fe=ie(()=>R("p",{class:"w-full text-4xl text-center text-white"},[T(" No results were found for your search "),R("br"),T(" :( ")],-1)),de=[fe],me={__name:"index",async setup(s){let o,e;const{sort:i}=F(),{filterByRuntime:a}=F(),{fetchShows:t}=ne(),w=[{label:"Rating",value:"-rating.average"},{label:"A -> Z",value:"name"},{label:"Z -> A",value:"-name"}],c=[{label:"All duration",value:"all"},{label:"Short",value:"short"},{label:"Medium",value:"medium"},{label:"Long",value:"long"}],n=x(""),p=x(w[0].value),_=x(c[0].value),y=x(null),{data:u}=([o,e]=W(()=>I(()=>t(n.value),{transform:d=>d.map(r=>n.value?r.show:r)},"$PslAyef5YX")),o=await o,e(),o),h=oe(async()=>{const{data:d}=await I(()=>t(n.value),{transform:r=>r.map(v=>n.value?v.show:v)},"$6PO73qLRkI");u.value=d.value},1e3,{maxWait:5e3});function l(){h()}const f=C(()=>i(p.value,u.value).filter(d=>a(d,_.value)).filter(d=>{var r;return!((r=y.value)!=null&&r.length)||y.value.every(v=>d.genres.indexOf(v)>=0)})),S=C(()=>{const d=[];return f.value.forEach(r=>{d.push(...r.genres)}),[...new Set(d)].map(r=>({label:r,value:r})).sort((r,v)=>r.label.localeCompare(v.label))});return(d,r)=>{var O;const v=$,E=j;return g(),P("div",le,[Z(v,{sortOptions:w,runtimeOptions:c,genreOptions:b(S),onUpdatedSearch:r[0]||(r[0]=m=>(n.value=m,l())),onUpdatedSortBy:r[1]||(r[1]=m=>p.value=m),onUpdatedRuntimeFilter:r[2]||(r[2]=m=>_.value=m),onUpdatedGenreFilter:r[3]||(r[3]=m=>y.value=m)},null,8,["genreOptions"]),(O=b(f))!=null&&O.length?(g(),P("div",ue,[(g(!0),P(G,null,K(b(f),(m,pe,_e,D)=>{const k=[];if(D&&D.key===m.id&&X(D,k))return D;const B=(g(),Y(E,{key:m.id,class:"snap-center shrink-0",show:m},null,8,["show"]));return B.memo=k,B},r,4),128))])):(g(),P("div",ce,de))])}}},be=ee(me,[["__scopeId","data-v-a1a91fee"]]);export{be as default};
