import{_ as U}from"./item.12337592.js";import{N as $,a as A,u as T}from"./useHelpers.09f664f7.js";import{q as I,r as x,t as V,s as q,v as M,w as L,u as c,x as W,y as Z,z as G,e as N,f as P,i as B,j as k,k as S,F as K,l as X,o as b,p as Y,c as J,m as z}from"./entry.5e953e57.js";import"./Icon.4727516b.js";import"./config.a2f8590e.js";import"./_plugin-vue_export-helper.c27b6911.js";const Q=()=>null;function E(...o){const s=typeof o[o.length-1]=="string"?o.pop():void 0;typeof o[0]!="string"&&o.unshift(s);let[e,l,a={}]=o;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof l!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??Q,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const t=I(),g=()=>t.isHydrating?t.payload.data[e]:t.static.data[e],f=()=>g()!==void 0;t._asyncData[e]||(t._asyncData[e]={data:x(g()??a.default()),pending:x(!f()),error:V(t.payload._errors,e)});const n={...t._asyncData[e]};n.refresh=n.execute=(u={})=>{if(t._asyncDataPromises[e]){if(u.dedupe===!1)return t._asyncDataPromises[e];t._asyncDataPromises[e].cancelled=!0}if((u._initial||t.isHydrating&&u._initial!==!1)&&f())return g();n.pending.value=!0;const _=new Promise((i,m)=>{try{i(l(t))}catch(O){m(O)}}).then(i=>{if(_.cancelled)return t._asyncDataPromises[e];let m=i;a.transform&&(m=a.transform(i)),a.pick&&(m=ee(m,a.pick)),n.data.value=m,n.error.value=null}).catch(i=>{if(_.cancelled)return t._asyncDataPromises[e];n.error.value=i,n.data.value=c(a.default())}).finally(()=>{_.cancelled||(n.pending.value=!1,t.payload.data[e]=n.data.value,n.error.value&&(t.payload._errors[e]=W(n.error.value)),delete t._asyncDataPromises[e])});return t._asyncDataPromises[e]=_,t._asyncDataPromises[e]};const d=()=>n.refresh({_initial:!0}),h=a.server!==!1&&t.payload.serverRendered;{const u=Z();if(u&&!u._nuxtOnBeforeMountCbs){u._nuxtOnBeforeMountCbs=[];const i=u._nuxtOnBeforeMountCbs;u&&(q(()=>{i.forEach(m=>{m()}),i.splice(0,i.length)}),M(()=>i.splice(0,i.length)))}h&&t.isHydrating&&f()?n.pending.value=!1:u&&(t.payload.serverRendered&&t.isHydrating||a.lazy)&&a.immediate?u._nuxtOnBeforeMountCbs.push(d):a.immediate&&d(),a.watch&&L(a.watch,()=>n.refresh());const _=t.hook("app:data:refresh",i=>{if(!i||i.includes(e))return n.refresh()});u&&M(_)}const y=Promise.resolve(t._asyncDataPromises[e]).then(()=>n);return Object.assign(y,n),y}function ee(o,s){const e={};for(const l of s)e[l]=o[l];return e}const te=()=>({fetchShows:async(s=null)=>s!=null&&s.length?await $fetch(`https://api.tvmaze.com/search/shows?q=${s}`,{transform:e=>e.show}):await $fetch("https://api.tvmaze.com/shows")});function j(o){return typeof o=="function"?o():c(o)}const H=()=>{};function ae(o,s){function e(...l){return new Promise((a,t)=>{Promise.resolve(o(()=>s.apply(this,l),{fn:s,thisArg:this,args:l})).then(a).catch(t)})}return e}function ne(o,s={}){let e,l,a=H;const t=f=>{clearTimeout(f),a(),a=H};return f=>{const n=j(o),d=j(s.maxWait);return e&&t(e),n<=0||d!==void 0&&d<=0?(l&&(t(l),l=null),Promise.resolve(f())):new Promise((h,y)=>{a=s.rejectOnCancel?y:h,d&&!l&&(l=setTimeout(()=>{e&&t(e),l=null,h(f())},d)),e=setTimeout(()=>{l&&t(l),l=null,h(f())},n)})}}function re(o,s=200,e={}){return ae(ne(s,e),o)}const se={class:"overflow-y-hidden"},oe={class:"gap-4 grid grid-cols-1 md:grid-cols-4 px-8 my-6 md:my-12"},le={key:0,class:"flex items-center snap-x space-x-8 snap-mandatory overflow-scroll px-8"},ie={key:1,class:"mt-40"},ue=B("p",{class:"w-full text-4xl text-center text-white"},[z(" Aucun résultat ne correspond à votre recherche "),B("br"),z(" :( ")],-1),ce=[ue],we={__name:"index",async setup(o){let s,e;const{sort:l}=T(),{filterByRuntime:a}=T(),{fetchShows:t}=te(),g=[{label:"Rating",value:"-rating.average"},{label:"A -> Z",value:"name"},{label:"Z -> A",value:"-name"}],f=[{label:"All duration",value:"all"},{label:"Short",value:"short"},{label:"Medium",value:"medium"},{label:"Long",value:"long"}],n=x(""),d=x(g[0].value),h=x(f[0].value),y=x(null),{data:u}=([s,e]=G(()=>E(()=>t(n.value),{transform:p=>p.map(r=>n.value?r.show:r)},"$PslAyef5YX")),s=await s,e(),s),_=re(async()=>{const{data:p}=await E(()=>t(n.value),{transform:r=>r.map(w=>n.value?w.show:w)},"$6PO73qLRkI");u.value=p.value},1e3,{maxWait:5e3});function i(){_()}const m=N(()=>l(d.value,u.value).filter(p=>a(p,h.value)).filter(p=>{var r;return!((r=y.value)!=null&&r.length)||y.value.every(w=>p.genres.indexOf(w)>=0)})),O=N(()=>{const p=[];return m.value.forEach(r=>{p.push(...r.genres)}),[...new Set(p)].map(r=>({label:r,value:r})).sort((r,w)=>r.label.localeCompare(w.label))});return(p,r)=>{var C;const w=U;return b(),P("div",se,[B("div",oe,[k(c($),{value:c(n),"onUpdate:value":[r[0]||(r[0]=v=>S(n)?n.value=v:null),i],type:"text",placeholder:"Search",clearable:""},null,8,["value"]),k(c(A),{value:c(d),"onUpdate:value":r[1]||(r[1]=v=>S(d)?d.value=v:null),options:g},null,8,["value"]),k(c(A),{value:c(h),"onUpdate:value":r[2]||(r[2]=v=>S(h)?h.value=v:null),options:f},null,8,["value"]),k(c(A),{value:c(y),"onUpdate:value":r[3]||(r[3]=v=>S(y)?y.value=v:null),options:c(O),placeholder:"Genres",clearable:"",multiple:""},null,8,["value","options"])]),(C=c(m))!=null&&C.length?(b(),P("div",le,[(b(!0),P(K,null,X(c(m),(v,fe,de,D)=>{const F=[];if(D&&D.key===v.id&&Y(D,F))return D;const R=(b(),J(w,{key:v.id,class:"snap-center shrink-0",show:v},null,8,["show"]));return R.memo=F,R},r,4),128))])):(b(),P("div",ie,ce))])}}};export{we as default};
